{
  "config": "baseline",
  "repo_dir": "/tmp/swebench_iu299bow/matplotlib__matplotlib",
  "wall_time_seconds": 128,
  "git_diff": "diff --git a/lib/matplotlib/artist.py b/lib/matplotlib/artist.py\nindex 1f33b9d3ec..130f4f8b85 100644\n--- a/lib/matplotlib/artist.py\n+++ b/lib/matplotlib/artist.py\n@@ -1304,10 +1304,14 @@ class Artist:\n             normed = self.norm(data)\n             if np.isfinite(normed):\n                 # Midpoints of neighboring color intervals.\n-                neighbors = self.norm.inverse(\n-                    (int(self.norm(data) * n) + np.array([0, 1])) / n)\n-                delta = abs(neighbors - data).max()\n-                g_sig_digits = cbook._g_sig_digits(data, delta)\n+                try:\n+                    neighbors = self.norm.inverse(\n+                        (int(self.norm(data) * n) + np.array([0, 1])) / n)\n+                    delta = abs(neighbors - data).max()\n+                    g_sig_digits = cbook._g_sig_digits(data, delta)\n+                except ValueError:\n+                    # norm.inverse is not defined (e.g., BoundaryNorm).\n+                    g_sig_digits = 3  # Consistent with default below.\n             else:\n                 g_sig_digits = 3  # Consistent with default below.\n             return \"[{:-#.{}g}]\".format(data, g_sig_digits)\ndiff --git a/lib/matplotlib/tests/test_image.py b/lib/matplotlib/tests/test_image.py\nindex e8e90b7680..59e26608b0 100644\n--- a/lib/matplotlib/tests/test_image.py\n+++ b/lib/matplotlib/tests/test_image.py\n@@ -354,6 +354,20 @@ def test_format_cursor_data(data, text):\n     assert im.format_cursor_data(im.get_cursor_data(event)) == text\n \n \n+def test_format_cursor_data_BoundaryNorm():\n+    \"\"\"BoundaryNorm is not invertible; format_cursor_data should not crash.\"\"\"\n+    from matplotlib.backend_bases import MouseEvent\n+\n+    fig, ax = plt.subplots()\n+    norm = mpl.colors.BoundaryNorm(np.linspace(-4, 4, 5), 256)\n+    im = ax.imshow(np.random.randn(10, 10), cmap='RdBu_r', norm=norm)\n+\n+    xdisp, ydisp = ax.transData.transform([0, 0])\n+    event = MouseEvent('motion_notify_event', fig.canvas, xdisp, ydisp)\n+    # Should not raise ValueError\n+    im.format_cursor_data(im.get_cursor_data(event))\n+\n+\n @image_comparison(['image_clip'], style='mpl20')\n def test_image_clip():\n     d = [[1, 2], [3, 4]]\n",
  "claude_output": {
    "type": "result",
    "subtype": "success",
    "is_error": false,
    "duration_ms": 6465,
    "duration_api_ms": 133954,
    "num_turns": 2,
    "result": "Empty \u2014 no `.so` files present, confirming the C extensions were never compiled. The environment is source-only with no built extensions, which is why tests can't run.\n\nThe patch is complete. The two files changed are:\n\n- **`lib/matplotlib/artist.py`**: wrap `self.norm.inverse()` in `try/except ValueError` to gracefully handle non-invertible norms like `BoundaryNorm`, falling back to 3 significant digits\n- **`lib/matplotlib/tests/test_image.py`**: added `test_format_cursor_data_BoundaryNorm` regression test",
    "stop_reason": null,
    "session_id": "741ae6ce-0839-4fa4-afe6-af2d2148d30c",
    "total_cost_usd": 0.9268055000000001,
    "usage": {
      "input_tokens": 4,
      "cache_creation_input_tokens": 461,
      "cache_read_input_tokens": 82706,
      "output_tokens": 224,
      "server_tool_use": {
        "web_search_requests": 0,
        "web_fetch_requests": 0
      },
      "service_tier": "standard",
      "cache_creation": {
        "ephemeral_1h_input_tokens": 461,
        "ephemeral_5m_input_tokens": 0
      },
      "inference_geo": "",
      "iterations": [],
      "speed": "standard"
    },
    "modelUsage": {
      "claude-sonnet-4-6": {
        "inputTokens": 51,
        "outputTokens": 5222,
        "cacheReadInputTokens": 1274468,
        "cacheCreationInputTokens": 22750,
        "webSearchRequests": 0,
        "costUSD": 0.9102264999999999,
        "contextWindow": 200000,
        "maxOutputTokens": 32000
      },
      "claude-haiku-4-5-20251001": {
        "inputTokens": 14189,
        "outputTokens": 478,
        "cacheReadInputTokens": 0,
        "cacheCreationInputTokens": 0,
        "webSearchRequests": 0,
        "costUSD": 0.016578999999999997,
        "contextWindow": 200000,
        "maxOutputTokens": 32000
      }
    },
    "permission_denials": [],
    "uuid": "18bc74eb-7c98-43f4-9208-ff6176223a50"
  },
  "session_id": "741ae6ce-0839-4fa4-afe6-af2d2148d30c",
  "result_text": "Empty \u2014 no `.so` files present, confirming the C extensions were never compiled. The environment is source-only with no built extensions, which is why tests can't run.\n\nThe patch is complete. The two files changed are:\n\n- **`lib/matplotlib/artist.py`**: wrap `self.norm.inverse()` in `try/except ValueError` to gracefully handle non-invertible norms like `BoundaryNorm`, falling back to 3 significant digits\n- **`lib/matplotlib/tests/test_image.py`**: added `test_format_cursor_data_BoundaryNorm` regression test",
  "total_cost_usd": 0.9268055000000001,
  "num_turns": 2
}